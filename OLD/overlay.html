<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Overlay Shoutout</title>
    <style>
        /* CSS CORRIGÉ POUR LE PLEIN ÉCRAN */
        body, html { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            overflow: hidden; 
            background: transparent; /* Fond transparent pour OBS */
        }
        
        #player {
            position: fixed; /* Utilise fixed pour bien se caler au viewport */
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; /* Prend 100% des 1920x1080 */
            display: none;
            /* Le reste du style (bordure/background) est optionnel ici si tu veux juste la vidéo */
        }
        
        iframe { 
            width: 100%; 
            height: 100%; 
            border: none; 
        }
    </style>
</head>
<body>
    <div id="player">
        <iframe id="clip-frame" src="" allow="autoplay; fullscreen"></iframe>
    </div>

    <script>
        // --- CONFIGURATION ---
        // L'adresse LOCALE de ton Pi.
        const PI_API_URL = "http://192.168.1.109:8080/api/overlay_status";
        let currentUrl = "";

        setInterval(() => {
            fetch(PI_API_URL)
                .then(r => r.json())
                .then(data => {
                    const div = document.getElementById('player');
                    const frame = document.getElementById('clip-frame');

                    if (data.active && data.url) {
                        if (currentUrl !== data.url) {
                            console.log("Nouveau clip détecté :", data.url);
                            frame.src = data.url;
                            currentUrl = data.url;
                            div.style.display = 'block';
                        }
                    } else {
                        if (div.style.display !== 'none') {
                            div.style.display = 'none';
                            frame.src = "";
                            currentUrl = "";
                        }
                    }
                })
                .catch(err => {
                    // Erreur silencieuse
                });
        }, 1000);
    </script>
</body>
</html>